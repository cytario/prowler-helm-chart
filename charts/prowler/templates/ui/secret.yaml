{{- $secretName := printf "%s-ui-auth" (include "prowler.fullname" .) -}}
{{- $secret := lookup "v1" "Secret" .Release.Namespace $secretName -}}
apiVersion: v1
kind: Secret
metadata:
  name: {{ $secretName }}
  labels:
    {{- include "prowler.labels" . | nindent 4 }}
type: Opaque
stringData:
  {{- if and $secret $secret.data }}
  # Reuse existing secret data to avoid regenerating on upgrade
  AUTH_SECRET: {{ index $secret.data "AUTH_SECRET" | b64dec | quote }}
  {{- else }}
  # WARNING: Auto-generated secret is NOT suitable for production use!
  # For production, generate your own: openssl rand -base64 32
  AUTH_SECRET: {{ randAlphaNum 32 | b64enc | quote }}
  {{- end }}
